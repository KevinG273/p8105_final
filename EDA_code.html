<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>EDA/Data Analysis</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="site_libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="site_libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="site_libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="data_cleaning.html">Data Cleaning</a>
</li>
<li>
  <a href="eda_code.html">EDA and Visualizations</a>
</li>
<li>
  <a href="modeling.html">Modeling</a>
</li>
<li>
  <a href="https://kevinguo273.shinyapps.io/shiny_dashboard/">Shiny Dashboard</a>
</li>
<li>
  <a href="report.html">Report</a>
</li>
<li>
  <a href="https://github.com/shehzrin/p8105_final.git">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">EDA/Data Analysis</h1>

</div>


<div id="loading-libraries-and-reading-data" class="section level2">
<h2>Loading Libraries and Reading Data</h2>
<pre class="r"><code>library(tidyverse) 
library(lubridate)
library(ggplot2)</code></pre>
<pre class="r"><code>gun_df = read.csv(&quot;data/mass_shootings_2018_2024_cleaned.csv&quot;) |&gt;
  janitor::clean_names()</code></pre>
</div>
<div id="structure-and-size-of-data" class="section level2">
<h2>Structure and Size of Data</h2>
<p>The dataset contains information on gun-related incidents from 2018
to 2024 across different cities and states in the United States. There
are a total of <code>nrow(gun_df)</code> observation and
<code>ncol(gun_df)</code> variables.</p>
<ul>
<li><code>date</code>: Date of the incident (class:
<code>Date</code>)</li>
<li><code>city</code>: City where the incident occurred (class:
<code>character</code>)</li>
<li><code>state</code>: State where the incident occurred (class:
<code>character</code>)</li>
<li><code>dead</code>: Number of fatalities (class:
<code>integer</code>)</li>
<li><code>injured</code>: Number of injuries (class:
<code>integer</code>)</li>
<li><code>total</code>: Total number of victims (Dead + Injured) (class:
<code>character</code>)</li>
<li><code>description</code>: Textual description of incident (class:
<code>character</code>)</li>
</ul>
<pre class="r"><code>glimpse(gun_df)</code></pre>
<pre><code>## Rows: 3,932
## Columns: 7
## $ date        &lt;chr&gt; &quot;2024-11-18&quot;, &quot;2024-11-17&quot;, &quot;2024-11-17&quot;, &quot;2024-11-16&quot;, &quot;2…
## $ city        &lt;chr&gt; &quot;Denver&quot;, &quot;New Orleans&quot;, &quot;Columbus&quot;, &quot;Walthall County&quot;, &quot;R…
## $ state       &lt;chr&gt; &quot;Colorado&quot;, &quot;Louisiana&quot;, &quot;Ohio&quot;, &quot;Mississippi&quot;, &quot;Californi…
## $ dead        &lt;int&gt; 0, 0, 0, 1, 0, 3, 1, 3, 1, 5, 0, 1, 0, 1, 2, 0, 3, 5, 0, 0…
## $ injured     &lt;int&gt; 4, 10, 4, 4, 4, 1, 4, 1, 3, 0, 4, 12, 5, 3, 2, 5, 3, 0, 4,…
## $ total       &lt;int&gt; 4, 10, 4, 5, 4, 4, 5, 4, 4, 5, 4, 13, 5, 4, 4, 5, 6, 5, 4,…
## $ description &lt;chr&gt; &quot;Four men were wounded at a strip mall following a dispute…</code></pre>
</div>
<div
id="comparing-number-of-incidents-by-year-quarter-month-and-weekday"
class="section level2">
<h2>Comparing Number of Incidents by Year, Quarter, Month, and
Weekday</h2>
<p>First, we will compare the number of incidents by year.</p>
<pre class="r"><code>gun_df = gun_df |&gt;
  mutate(date = as.Date(date), 
         year = year(date)) 

gun_plot = gun_df |&gt;
  ggplot(aes(x = as.factor(year))) +
  geom_bar(fill = &quot;red&quot;) +
  scale_y_continuous(
    labels = scales::comma,
    limits = c(0, NA),  
    expand = expansion(mult = c(0, 0.15))  
  ) +
  geom_label(stat = &quot;count&quot;, aes(label = after_stat(count), y = after_stat(count)), vjust = -0.5) +
  labs(
    title = &quot;Number of Gun-Related Incidents by Year&quot;,
    x = &quot;Year&quot;,
    y = &quot;Number of Incidents&quot;
  ) 

print(gun_plot)</code></pre>
<p><img src="EDA_code_files/figure-html/unnamed-chunk-5-1.png" width="90%" /></p>
<p>The graph shows a general upward trend in gun-related incidents from
2018 to 2022. The peak would be at 717 incidents. The year 2020 shows a
significant increase, rising from 441 incidents in 2019 to 617
incidents, and the trend continues with 703 incidents in 2021. However,
from 2023 to 2024, the number of incidents appear to decline, with 596
incidents in 2023 and 538 incidents in 2024. This suggests that while
the number of incidents has increased over the past few years, the
decline in recent years might reflect a shift in trends or external
factors impacting the data. Further analysis would be needed to
understand the variations in detail.</p>
<p>We will now compare the number of incidents by quarter for each
year.</p>
<pre class="r"><code>gun_df = gun_df |&gt;
  mutate(date = as.Date(date, format = &quot;%Y-%m-%d&quot;),
         year = year(date),
         quarter = quarter(date)
  )

gun1_plot = gun_df |&gt;
  ggplot(aes(x = factor(quarter), fill = factor(year))) +
  geom_bar(position = &quot;dodge&quot;) + 
  labs(
    title = &quot;Number of Gun-Related Incidents by Quarter (2014-2024)&quot;,
    x = &quot;Quarter&quot;,
    y = &quot;Number of Incidents&quot;,
    fill = &quot;Year&quot;
  )
print(gun1_plot)</code></pre>
<p><img src="EDA_code_files/figure-html/unnamed-chunk-6-1.png" width="90%" /></p>
<p>Let’s further break it down by years and quarters.</p>
<pre class="r"><code>q1 = gun_df |&gt;
  filter(year != 2013) |&gt;
  select(year, quarter) |&gt;
  group_by(year) |&gt;
  count(quarter) |&gt;
  ggplot(aes(x = as.factor(quarter), y = n)) + 
  geom_bar(stat = &#39;identity&#39;) + 
  scale_y_continuous(labels = scales::comma) + 
  facet_grid(. ~ year) + 
  labs(x = &#39;Quarter&#39;, y = &#39;Number of incidents&#39;)

q2 = gun_df |&gt;
  filter(year != 2013 &amp; quarter == 1) |&gt;
  select(year, quarter) |&gt;
  group_by(year) |&gt;
  count(quarter) |&gt;
  ggplot(aes(x = as.factor(year), y = n)) + 
  geom_bar(stat = &#39;identity&#39;) + 
  scale_y_continuous(labels = scales::comma) + 
  labs(x = &#39;Incidents in Q1 of each year&#39;, y = &#39;Number of incidents&#39;)

gridExtra::grid.arrange(q1, q2)</code></pre>
<p><img src="EDA_code_files/figure-html/unnamed-chunk-7-1.png" width="90%" /></p>
<p>The dataset on incidents of gun violence from 2018-2024 show some
seasonality. We notice incidents in Q1 and Q4 are generally lower than
those in Q2 and Q3. The second graph highlights that Q1 incidents
increased steadily from 2018 to 2021, with smaller increases observed
between 2021 and 2022, as well as between 2022 and 2023, suggesting a
leveling-off trend during this period. In 2024, there is a slight
decrease compared to 2023, but it is important to consider that 2024 is
not yet complete. This potential plateau in Q1 incidents could signal a
stabilization, though the overall trend since 2018 indicates a
significant increase that still warrants attention.</p>
<p>We will now compare the number of incidents by months.</p>
<pre class="r"><code>gun_df$month &lt;- month(gun_df$date, label = TRUE)

gun2_plot = plotly::ggplotly(
  gun_df |&gt;
    filter(year != c(2013, 2018)) |&gt;
    count(month) |&gt;
    ggplot(aes(x = month, y = n)) + 
    geom_bar(stat = &#39;identity&#39;, fill = &#39;red&#39;) + 
    scale_y_continuous(labels = scales::comma) + 
    labs(x = &#39;Month&#39;, y = &#39;Number of incidents&#39;, title = &#39;Incidents by Month&#39;)
)

gun2_plot</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-52cfde47af740edf2752" style="width:90%;height:345.6px;"></div>
<script type="application/json" data-for="htmlwidget-52cfde47af740edf2752">{"x":{"data":[{"orientation":"v","width":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858],"base":[0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7,8,9,10,11,12],"y":[244,222,236,290,388,464,495,372,317,303,255,186],"text":["month: Jan<br />n: 244","month: Feb<br />n: 222","month: Mar<br />n: 236","month: Apr<br />n: 290","month: May<br />n: 388","month: Jun<br />n: 464","month: Jul<br />n: 495","month: Aug<br />n: 372","month: Sep<br />n: 317","month: Oct<br />n: 303","month: Nov<br />n: 255","month: Dec<br />n: 186"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":45.710806697108076,"r":7.3059360730593621,"b":42.130898021308994,"l":43.105022831050235},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Incidents by Month","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342468},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,12.6],"tickmode":"array","ticktext":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"tickvals":[1,2,3,4.0000000000000009,5,6,7.0000000000000009,8,9,10,11,12],"categoryorder":"array","categoryarray":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Month","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-24.75,519.75],"tickmode":"array","ticktext":["0","100","200","300","400","500"],"tickvals":[0,100,200,300,400,500],"categoryorder":"array","categoryarray":["0","100","200","300","400","500"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Number of incidents","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"35f9ebdaa88":{"x":{},"y":{},"type":"bar"}},"cur_data":"35f9ebdaa88","visdat":{"35f9ebdaa88":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>The graph shows the number of incidents by month. Again, we see a
clear seasonal trend. Incidents steadily rise from January through July,
peaking in July (likely due to heightened activity during the summer
months). A sharp decline follows from August to December, with November
and December showing the lowest numbers. This could be influenced by
colder weather, holiday periods, or shorter months (i.e., February). The
visible trends suggest a relationship between weather (seasonal
variations), social behavior, and incident rates. You can hover over the
bars for exact values to compare these trends in more detail.</p>
<p>Let’s see the dates with the most incidents.</p>
<pre class="r"><code>gun_df$day = day(gun_df$date)  
gun_df = gun_df |&gt; mutate(date2 = paste(month, day)) 

knitr::kable(
  gun_df |&gt; 
    filter(year != c(2013, 2018)) |&gt; 
    count(date2) |&gt; 
    top_n(10) |&gt; 
    arrange(desc(n)) |&gt; 
    rename(date = date2, &quot;total number of incidents&quot; = n)
)</code></pre>
<pre><code>## Selecting by n</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">date</th>
<th align="right">total number of incidents</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Jul 5</td>
<td align="right">49</td>
</tr>
<tr class="even">
<td align="left">Jul 4</td>
<td align="right">48</td>
</tr>
<tr class="odd">
<td align="left">Jan 1</td>
<td align="right">31</td>
</tr>
<tr class="even">
<td align="left">Jun 11</td>
<td align="right">26</td>
</tr>
<tr class="odd">
<td align="left">Jul 28</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="left">Jun 17</td>
<td align="right">23</td>
</tr>
<tr class="odd">
<td align="left">Jun 20</td>
<td align="right">22</td>
</tr>
<tr class="even">
<td align="left">Jun 23</td>
<td align="right">22</td>
</tr>
<tr class="odd">
<td align="left">Jul 23</td>
<td align="right">21</td>
</tr>
<tr class="even">
<td align="left">May 18</td>
<td align="right">21</td>
</tr>
</tbody>
</table>
<p>The table highlights the dates with the highest total number of
incidents, aggregated over 2018-2024. July 5th and July 4th stand out
with 49 and 48 incidents respectively, indicating that Independence Day
celebrations significantly contribute to increased incidents, likely due
to festivities and the use of fireworks or firearms. January 1st, with
31 incidents, suggests that New Year’s Day also brings heightened risk,
potentially linked to post-midnight celebrations and gatherings. The
remaining dates predominantly occur in late June and July, with totals
ranging from 21 to 26 incidents, reflecting a seasonal peak in incidents
during summer months. May 18th, while slightly earlier, still aligns
closely with this summer trend, reinforcing the pattern of increased
incidents during warmer months. These results show the influence of
holidays and seasonal trends on incident rates.</p>
<p>We will now compare the number of incidents by weekday.</p>
<pre class="r"><code>gun_df$weekday = wday(gun_df$date, label = TRUE)

gun_df |&gt; 
  count(weekday) |&gt; 
  ggplot(aes(x = weekday, y = n)) + 
  geom_bar(stat = &#39;identity&#39;, fill = &#39;red&#39;) + 
  scale_y_continuous(labels = scales::comma) + 
  labs(x = &#39;Weekday&#39;, y = &#39;Number of incidents&#39;, title = &#39;Incidents by Weekday&#39;)</code></pre>
<p><img src="EDA_code_files/figure-html/unnamed-chunk-10-1.png" width="90%" /></p>
<p>Sunday stands out as the most dangerous day, with incidents far
exceeding 900. Saturdays follow closely with around 900 incidents.
Fridays show a moderate increase with about 450 incidents, marking the
start of the weekend.Meanwhile, weekdays see significantly lower
numbers, with Tuesday recording the fewest incidents at around 200,
followed by Thursday at about 350, Wednesday at 375, and Monday at 440.
This trend show the influence of weekends or leisure culture on the
frequency of incidents, with weekdays being relatively safer perhaps due
to structured routines and fewer late-night activities.</p>
</div>
<div id="incidents-by-state" class="section level2">
<h2>Incidents by state</h2>
<pre class="r"><code>gun_df[, c(&#39;state&#39;, &#39;city&#39;)] &lt;- lapply(gun_df[, c(&#39;state&#39;, &#39;city&#39;)], as.factor)
str(gun_df$state)</code></pre>
<pre><code>##  Factor w/ 53 levels &quot;Alabama&quot;,&quot;Alaska&quot;,..: 6 19 36 25 5 5 5 5 32 17 ...</code></pre>
<pre class="r"><code>str(gun_df$city)</code></pre>
<pre><code>##  Factor w/ 1158 levels &quot;Abbeville&quot;,&quot;Aberdeen&quot;,..: 259 730 214 1081 871 583 722 909 14 1120 ...</code></pre>
<pre class="r"><code>plotly::ggplotly(gun_df %&gt;% 
                   count(state) %&gt;%
        ggplot(aes(x=reorder(state, n), y=n, fill=n, text=state)) +
        geom_bar(stat=&#39;identity&#39;, fill=&#39;red&#39;) +
        theme(axis.text.x = element_text(angle = 80, hjust = 1))+
        labs(x=&#39;&#39;, y=&#39;Number of incidents&#39;),
        tooltip=c(&quot;text&quot;, &quot;y&quot;))</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-499eb2d7f86bc9d4a3a3" style="width:90%;height:345.6px;"></div>
<script type="application/json" data-for="htmlwidget-499eb2d7f86bc9d4a3a3">{"x":{"data":[{"orientation":"v","width":[0.90000000000000568,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000568,0.90000000000000568,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000568,0.90000000000000568,0.89999999999999858,0.90000000000000036,0.90000000000000568,0.90000000000000568,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000568,0.90000000000000036,0.90000000000000568,0.89999999999999858,0.90000000000000568,0.89999999999999858,0.90000000000000568,0.90000000000000568,0.90000000000000036,0.89999999999999858,0.89999999999999858,0.90000000000000013,0.90000000000000568,0.89999999999999858,0.90000000000000568,0.90000000000000568,0.90000000000000036,0.90000000000000568,0.89999999999999858,0.89999999999999858,0.90000000000000568,0.89999999999999858,0.90000000000000036,0.90000000000000568,0.89999999999999947,0.90000000000000568,0.90000000000000568,0.89999999999999858,0.89999999999999858,0.90000000000000568,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000213,0.89999999999999991],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[39,9,26,27,51,34,22,17,31,50,45,10,4,53,36,18,19,30,48,7,40,24,42,29,37,43,5,16,23,2,33,21,47,44,3,46,25,20,49,14,6,38,8,41,52,11,12,35,28,13,15,32,1],"y":[115,6,46,49,297,71,24,17,57,211,148,6,3,364,85,19,21,56,166,4,115,35,125,54,94,125,3,13,31,2,66,22,163,144,2,150,45,21,201,10,3,94,4,119,299,6,6,82,51,8,11,62,1],"text":["n: 115<br />Alabama","n:   6<br />Alaska","n:  46<br />Arizona","n:  49<br />Arkansas","n: 297<br />California","n:  71<br />Colorado","n:  24<br />Connecticut","n:  17<br />Delaware","n:  57<br />District of Columbia","n: 211<br />Florida","n: 148<br />Georgia","n:   6<br />Hawaii","n:   3<br />Idaho","n: 364<br />Illinois","n:  85<br />Indiana","n:  19<br />Iowa","n:  21<br />Kansas","n:  56<br />Kentucky","n: 166<br />Louisiana","n:   4<br />Maine","n: 115<br />Maryland","n:  35<br />Massachusetts","n: 125<br />Michigan","n:  54<br />Minnesota","n:  94<br />Mississippi","n: 125<br />Missouri","n:   3<br />Montana","n:  13<br />Nebraska","n:  31<br />Nevada","n:   2<br />New Hampshire","n:  66<br />New Jersey","n:  22<br />New Mexico","n: 163<br />New York","n: 144<br />North Carolina","n:   2<br />North Dakota","n: 150<br />Ohio","n:  45<br />Oklahoma","n:  21<br />Oregon","n: 201<br />Pennsylvania","n:  10<br />Puerto Rico","n:   3<br />Rhode Island","n:  94<br />South Carolina","n:   4<br />South Dakota","n: 119<br />Tennessee","n: 299<br />Texas","n:   6<br />United States Virgin Islands","n:   6<br />Utah","n:  82<br />Virginia","n:  51<br />Washington","n:   8<br />Washington, D.C.","n:  11<br />West Virginia","n:  62<br />Wisconsin","n:   1<br />Wyoming"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":28.176560121765604,"r":7.3059360730593621,"b":27.519025875190266,"l":43.105022831050235},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,53.600000000000001],"tickmode":"array","ticktext":["Wyoming","New Hampshire","North Dakota","Idaho","Montana","Rhode Island","Maine","South Dakota","Alaska","Hawaii","United States Virgin Islands","Utah","Washington, D.C.","Puerto Rico","West Virginia","Nebraska","Delaware","Iowa","Kansas","Oregon","New Mexico","Connecticut","Nevada","Massachusetts","Oklahoma","Arizona","Arkansas","Washington","Minnesota","Kentucky","District of Columbia","Wisconsin","New Jersey","Colorado","Virginia","Indiana","Mississippi","South Carolina","Alabama","Maryland","Tennessee","Michigan","Missouri","North Carolina","Georgia","Ohio","New York","Louisiana","Pennsylvania","Florida","California","Texas","Illinois"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,14.999999999999998,16,17,18,19,20,21,22,23,24,25,26,27,28,29.000000000000004,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53],"categoryorder":"array","categoryarray":["Wyoming","New Hampshire","North Dakota","Idaho","Montana","Rhode Island","Maine","South Dakota","Alaska","Hawaii","United States Virgin Islands","Utah","Washington, D.C.","Puerto Rico","West Virginia","Nebraska","Delaware","Iowa","Kansas","Oregon","New Mexico","Connecticut","Nevada","Massachusetts","Oklahoma","Arizona","Arkansas","Washington","Minnesota","Kentucky","District of Columbia","Wisconsin","New Jersey","Colorado","Virginia","Indiana","Mississippi","South Carolina","Alabama","Maryland","Tennessee","Michigan","Missouri","North Carolina","Georgia","Ohio","New York","Louisiana","Pennsylvania","Florida","California","Texas","Illinois"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-80,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-18.199999999999999,382.19999999999999],"tickmode":"array","ticktext":["0","100","200","300"],"tickvals":[0,100.00000000000001,200,300],"categoryorder":"array","categoryarray":["0","100","200","300"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Number of incidents","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"35f9470e09ae":{"x":{},"y":{},"fill":{},"text":{},"type":"bar"}},"cur_data":"35f9470e09ae","visdat":{"35f9470e09ae":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>The interactive bar graph above shows absolute number of gun violence
by states. Hovering over the bars shows a label with the absolute Number
of Incidents for a State. Illinois has the highest number of gun
violence cases followed by California.</p>
</div>
<div id="victims-by-state" class="section level2">
<h2>Victims by state</h2>
<pre class="r"><code>gun_df$victims &lt;- gun_df$dead + gun_df$injured

VictimsByState &lt;- gun_df %&gt;% 
  group_by(state) %&gt;% 
  summarize(sumVic=sum(victims), sumInj=sum(injured), sumDeath=sum(dead), PercDeath=round(sumDeath/sumVic,2), sumIncidents=n(), vicPerInc=round(sumVic/sumIncidents,2))
head(VictimsByState)</code></pre>
<pre><code>## # A tibble: 6 × 7
##   state      sumVic sumInj sumDeath PercDeath sumIncidents vicPerInc
##   &lt;fct&gt;       &lt;int&gt;  &lt;int&gt;    &lt;int&gt;     &lt;dbl&gt;        &lt;int&gt;     &lt;dbl&gt;
## 1 Alabama       647    516      131      0.2           115      5.63
## 2 Alaska         26     14       12      0.46            6      4.33
## 3 Arizona       260    193       67      0.26           46      5.65
## 4 Arkansas      265    208       57      0.22           49      5.41
## 5 California   1564   1174      390      0.25          297      5.27
## 6 Colorado      382    278      104      0.27           71      5.38</code></pre>
<pre class="r"><code>VictimsByState %&gt;% 
  filter(vicPerInc&gt;0.8) %&gt;%
        ggplot(aes(x=reorder(state, -vicPerInc), y=vicPerInc)) + geom_bar(stat=&#39;identity&#39;, fill=&#39;red&#39;) +
        labs(x=&#39;State&#39;, y=&#39;Victims per incidents&#39;) +
        theme(axis.text.x = element_text(angle = 80, hjust = 1))</code></pre>
<p><img src="EDA_code_files/figure-html/unnamed-chunk-13-1.png" width="90%" /></p>
<p>The bar graph above shows the number of victims per incident by
state. Maine has the highest victims by incidents followed by Washington
Dc followed by Puerto Rico.</p>
</div>
<div id="incidents-by-city" class="section level2">
<h2>Incidents by city</h2>
<pre class="r"><code>incidentsByCity &lt;- gun_df%&gt;% 
  select(city, state) %&gt;% 
  group_by(city, state) %&gt;% 
  summarize(cityIncidents=n())</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;city&#39;. You can override using the
## `.groups` argument.</code></pre>
<pre class="r"><code>incidentsByCity[(incidentsByCity$city %in% c(&#39;Brooklyn&#39;, &#39;Bronx&#39;, &#39;Queens&#39;, &#39;Staten Island&#39;,&#39;New York (Manhattan)&#39;)) &amp; incidentsByCity$state==&#39;New York&#39;,]</code></pre>
<pre><code>## # A tibble: 0 × 3
## # Groups:   city [0]
## # ℹ 3 variables: city &lt;fct&gt;, state &lt;fct&gt;, cityIncidents &lt;int&gt;</code></pre>
<pre class="r"><code>sumNewYork &lt;- sum(incidentsByCity$cityIncidents[(incidentsByCity$city %in% c(&#39;Brooklyn&#39;, &#39;Bronx&#39;, &#39;Queens&#39;, &#39;Staten Island&#39;,&#39;New York (Manhattan)&#39;)) &amp; incidentsByCity$state==&#39;New York&#39;])

NewYork &lt;- data.frame(city=&#39;New York&#39;, state=&#39;New York&#39;, cityIncidents=sumNewYork)
incidentsByCity &lt;- as.tibble(rbind(as.data.frame(incidentsByCity), NewYork))</code></pre>
<pre class="r"><code>incidentsByCity %&gt;% top_n(20, wt=cityIncidents) %&gt;%
        ggplot(aes(x=reorder(city, cityIncidents), y=cityIncidents)) + geom_bar(stat=&#39;identity&#39;, fill=&#39;red&#39;) +
        labs(x=&#39;City&#39;, y=&#39;Number of incidents&#39;) + coord_flip()</code></pre>
<p><img src="EDA_code_files/figure-html/unnamed-chunk-17-1.png" width="90%" /></p>
<p>The bar graph above shows the number of incidents by city. Chichago
has the highest number of incidents (~260) followed by Philadelphia
(~130) followed by New York city (~90).</p>
<pre class="r"><code>gun_df &lt;- read.csv(&quot;data/mass_shootings_2018_2024_cleaned.csv&quot;) |&gt;
  janitor::clean_names()
uscities &lt;- read.csv(&quot;data/simplemaps_uscities/uscities.csv&quot;) |&gt;
  janitor::clean_names()</code></pre>
</div>
<div id="load-necessary-libraries" class="section level1">
<h1>Load necessary libraries</h1>
<pre class="r"><code>library(leaflet)
library(dplyr)</code></pre>
</div>
<div id="merge-datasets-to-add-lat-and-lon-to-gun_df"
class="section level1">
<h1>Merge datasets to add lat and lon to gun_df</h1>
<pre class="r"><code>gun_df &lt;- gun_df |&gt;
  left_join(
    uscities |&gt; select(city, state_name, lat, lng),
    by = c(&quot;city&quot; = &quot;city&quot;, &quot;state&quot; = &quot;state_name&quot;)
  )

write.csv(gun_df, &quot;gun_df.csv&quot;)</code></pre>
<div id="incidents-with-highet-number-of-victims"
class="section level2">
<h2>incidents with highet number of victims</h2>
<pre class="r"><code>top_incidents &lt;- gun_df |&gt; 
  select(date, city, state, dead, injured, total, description, lat, lng) |&gt; 
  arrange(desc(total)) |&gt; 
  slice(1:13)

top_incidents</code></pre>
<pre><code>##          date             city      state dead injured total
## 1  2022-07-04    Highland Park   Illinois    7      48    55
## 2  2019-08-03          El Paso      Texas   23      22    45
## 3  2022-05-24           Uvalde      Texas   22      18    40
## 4  2019-08-04           Dayton       Ohio   10      27    37
## 5  2023-04-15        Dadeville    Alabama    4      32    36
## 6  2018-02-14         Parkland    Florida   17      17    34
## 7  2023-10-25         Lewiston      Maine   19      13    32
## 8  2024-06-02            Akron       Ohio    1      29    30
## 9  2023-07-02        Baltimore   Maryland    2      28    30
## 10 2018-11-07    Thousand Oaks California   13      16    29
## 11 2022-03-19            Dumas   Arkansas    1      26    27
## 12 2022-11-19 Colorado Springs   Colorado    5      19    24
## 13 2018-05-18         Santa Fe      Texas   10      14    24
##                                                                                                                                                                                                                                                                                                                                                                                                                        description
## 1                                            Highland Park parade shooting: Seven people were killed and 48 others were wounded after a person opened fire from a rooftop on people attending an Independence Day parade. Eleven others were injured fleeing the scene. The shooter also admitted he had plans to drive to Madison, Wisconsin, to shoot more people. He was charged with a total of 117 counts later in the month.
## 2                                                                                                                                                                                                                                                     2019 El Paso shooting: 23 people were killed and 22 were injured at a Walmart near the Cielo Vista Mall in a Hispanophobic massacre. The perpetrator was taken into custody.
## 3  Robb Elementary School shooting: An 18-year-old shot his grandmother at their home before driving to Robb Elementary School, where he entered the school unobstructed, barricading himself inside a classroom and fatally shooting twenty-one people, including nineteen children. Eighteen people in total were wounded. The shooter was eventually fatally shot by a Border Patrol officer, who was shot during the shootout.
## 4                                                                                                                                                                                                                                                                                      2019 Dayton shooting: A gunman killed nine people and injured 27 outside of a bar after he was denied entry, before being killed by police.
## 5                                                                                                                                                                                                                                                             2023 Dadeville shooting: Four were killed and thirty-two were injured at a 16th birthday party at the Mahogany Masterpiece Dance Studio after an argument escalated.
## 6                                                                                                                                                                                                                          Parkland high school shooting: A former student of Marjory Stoneman Douglas High School entered the school, killed seventeen people, and wounded seventeen others. He was taken into custody by police.
## 7                                                                                                                                                                                                 2023 Lewiston shootings: Eighteen people were killed and thirteen others were injured in a spree shooting at a bowling alley and a bar. The shooter was found dead two days later from an apparent self-inflicted gunshot wound.
## 8                                                                                                                                                                                                                                                                                                                        A man was killed and at least twenty-nine others were injured in an overnight shooting at a street party.
## 9                                                                                                                                                                                                                                                                                                                                   2023 Baltimore shooting: Two people were killed and 28 people were injured in South Baltimore.
## 10                                                                                                                                                                                               Thousand Oaks shooting: A man entered a bar hosting a student line-dancing event and killed twelve people, including a police officer. Sixteen other people were injured, one of them by gunfire. The gunman then killed himself.
## 11                                                                                                                                                                                                                                                                                                               A gunfight between two people at a car show killed one bystander, and wounded 26 others, including five children.
## 12                                                                                                                                                 Colorado Springs nightclub shooting: Five people were killed and 25 others injured, 19 by gunfire, in a shooting inside Club Q, a gay nightclub. Six additional people were injured in the chaos. The shooting happened just before midnight of Transgender Day of Remembrance.
## 13                                                                                                                                                                                          Santa Fe High School shooting: A student at Santa Fe High School shot and killed ten people and wounded fourteen others. Explosive devices were also found, but they were not detonated. The suspect was taken into custody by police.
##        lat       lng
## 1  42.1823  -87.8104
## 2  31.8476 -106.4300
## 3  29.2152  -99.7782
## 4  39.7805  -84.2003
## 5  32.8326  -85.7675
## 6  26.3219  -80.2533
## 7  44.0915  -70.1681
## 8  41.0798  -81.5219
## 9  39.3051  -76.6144
## 10 34.1914 -118.8756
## 11 33.8834  -91.4857
## 12 38.8674 -104.7605
## 13 29.3889  -95.1003</code></pre>
<p>The above shows the 13 most severe gun-related incidents in the
dataset, ranked by the total number of victims (dead and injured). The
incidents range from mass shootings at public events to tragic attacks
in schools and other locations. Each entry provides details on the
location, date, fatalities, injuries, and a brief description of the
event, offering insights into the magnitude and context of these
tragedies.</p>
</div>
<div
id="interactive-map-of-the-incidents-with-highest-numbers-of-victims"
class="section level2">
<h2>Interactive Map of the Incidents with highest numbers of
victims</h2>
<pre class="r"><code>labels &lt;- paste0(
  &quot;&lt;strong&gt;Date:&lt;/strong&gt; &quot;, top_incidents$Date, &quot;&lt;br&gt;&quot;,
  &quot;&lt;strong&gt;City:&lt;/strong&gt; &quot;, top_incidents$city, &quot;&lt;br&gt;&quot;,
  &quot;&lt;strong&gt;State:&lt;/strong&gt; &quot;, top_incidents$state, &quot;&lt;br&gt;&quot;,
  &quot;&lt;strong&gt;Total Victims:&lt;/strong&gt; &quot;, top_incidents$Total, &quot;&lt;br&gt;&quot;,
  &quot;&lt;strong&gt;Description:&lt;/strong&gt; &quot;, top_incidents$Description
) |&gt; lapply(htmltools::HTML)

leaflet(top_incidents) |&gt;
  setView(lng=-96, lat=37.8, zoom=4)|&gt;
  addTiles() |&gt; 
  addProviderTiles(&quot;CartoDB.Positron&quot;) |&gt;
  addCircleMarkers( ~lng, ~lat, color = &quot;red&quot;, radius = ~sqrt(total), 
    label = labels, 
    fillOpacity = 0.7
  ) </code></pre>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-8d17e4e17f0ecd4b8a53" style="width:90%;height:345.6px;"></div>
<script type="application/json" data-for="htmlwidget-8d17e4e17f0ecd4b8a53">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"setView":[[37.8,-96],4,[]],"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addProviderTiles","args":["CartoDB.Positron",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[42.1823,31.8476,29.2152,39.7805,32.8326,26.3219,44.0915,41.0798,39.3051,34.1914,33.8834,38.8674,29.3889],[-87.8104,-106.43,-99.7782,-84.2003,-85.7675,-80.2533,-70.1681,-81.5219,-76.6144,-118.8756,-91.48569999999999,-104.7605,-95.1003],[7.416198487095663,6.708203932499369,6.324555320336759,6.082762530298219,6,5.830951894845301,5.656854249492381,5.477225575051661,5.477225575051661,5.385164807134504,5.196152422706632,4.898979485566356,4.898979485566356],null,null,{"interactive":true,"className":"","stroke":true,"color":"red","weight":5,"opacity":0.5,"fill":true,"fillColor":"red","fillOpacity":0.7},null,null,null,null,["<strong>Date:<\/strong> <br><strong>City:<\/strong> Highland Park<br><strong>State:<\/strong> Illinois<br><strong>Total Victims:<\/strong> <br><strong>Description:<\/strong> ","<strong>Date:<\/strong> <br><strong>City:<\/strong> El Paso<br><strong>State:<\/strong> Texas<br><strong>Total Victims:<\/strong> <br><strong>Description:<\/strong> ","<strong>Date:<\/strong> <br><strong>City:<\/strong> Uvalde<br><strong>State:<\/strong> Texas<br><strong>Total Victims:<\/strong> <br><strong>Description:<\/strong> ","<strong>Date:<\/strong> <br><strong>City:<\/strong> Dayton<br><strong>State:<\/strong> Ohio<br><strong>Total Victims:<\/strong> <br><strong>Description:<\/strong> ","<strong>Date:<\/strong> <br><strong>City:<\/strong> Dadeville<br><strong>State:<\/strong> Alabama<br><strong>Total Victims:<\/strong> <br><strong>Description:<\/strong> ","<strong>Date:<\/strong> <br><strong>City:<\/strong> Parkland<br><strong>State:<\/strong> Florida<br><strong>Total Victims:<\/strong> <br><strong>Description:<\/strong> ","<strong>Date:<\/strong> <br><strong>City:<\/strong> Lewiston<br><strong>State:<\/strong> Maine<br><strong>Total Victims:<\/strong> <br><strong>Description:<\/strong> ","<strong>Date:<\/strong> <br><strong>City:<\/strong> Akron<br><strong>State:<\/strong> Ohio<br><strong>Total Victims:<\/strong> <br><strong>Description:<\/strong> ","<strong>Date:<\/strong> <br><strong>City:<\/strong> Baltimore<br><strong>State:<\/strong> Maryland<br><strong>Total Victims:<\/strong> <br><strong>Description:<\/strong> ","<strong>Date:<\/strong> <br><strong>City:<\/strong> Thousand Oaks<br><strong>State:<\/strong> California<br><strong>Total Victims:<\/strong> <br><strong>Description:<\/strong> ","<strong>Date:<\/strong> <br><strong>City:<\/strong> Dumas<br><strong>State:<\/strong> Arkansas<br><strong>Total Victims:<\/strong> <br><strong>Description:<\/strong> ","<strong>Date:<\/strong> <br><strong>City:<\/strong> Colorado Springs<br><strong>State:<\/strong> Colorado<br><strong>Total Victims:<\/strong> <br><strong>Description:<\/strong> ","<strong>Date:<\/strong> <br><strong>City:<\/strong> Santa Fe<br><strong>State:<\/strong> Texas<br><strong>Total Victims:<\/strong> <br><strong>Description:<\/strong> "],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[26.3219,44.0915],"lng":[-118.8756,-70.1681]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
